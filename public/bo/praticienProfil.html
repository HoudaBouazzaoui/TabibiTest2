<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8' />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <script src="../js/utils.js"></script>

    <link href='../css/main.css' rel='stylesheet' />
    <!---->
    <!---->

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>


    <!-- popup modal-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>

    <script>

        $(document).ready(function () {

            recupererSpecialite('/cache', "#id_speCat");

            recupererPraticien();

            $("#successModal").modal("show");

            $("#creerPraticien").submit(function (event) {
                var praticien = construirePraticien();
                // $("#successModal").modal('hide');
                modifierPraticien(praticien);
                return false;
            });
        });

        function recupererPraticien() {
            $.ajax({
                type: "GET",
                //contentType: "application/json",
                dataType: 'json',
                url: "http://localhost:4000/pra/pra",
                cache: true,
                success: function (data) {
                    var iwa = JSON.stringify(data);
                    //$("#successModal .modal-body p").text('creerr = ' + data.id);

                    afficherResultat(data);

                    peuplerFormPraticien(data);

                    console.log("success     okkkk" + iwa);
                    selectSpecialite(data);
                },
                error: function (xhr, desc, err) {
                    $("#successModal .modal-body p").text('error = ' + xhr.responseJSON.message);
                    console.log(xhr.responseJSON.message);
                    console.log("Details0: " + desc + "\nError:" + err);
                }
            });
        }

        function afficherResultat(pra) {
            var listItems = '';

            listItems += '<div class="">';
            listItems += '<div class=""> Dr ' + pra.titre + ' ' + pra.prenom + ' ' + pra.nom + '</div>';
            listItems += '</div>';

            $("#resu").html(listItems);
        }
        
        function modifierPraticien(praticien) {

            const praid = praticien.id;
            alert('praid = ' + praid);

            const praData = JSON.stringify(praticien);
            alert(praData);
            console.log(praData);

            $.ajax({
                type: "PUT",
                contentType: "application/json",
                dataType: 'json',
                url: "http://localhost:4000/pra/mod/"+praid,
                cache: false,
                data: praData,
                success: function (data) {
                    var iwa = JSON.stringify(data);
                    $("#successModal .modal-body p").text(iwa);
                    console.log("success     okkkk" + iwa);
                },
                error: function (xhr, desc, err) {
                    //alert('error = ');
                    var errMessage;
                    if(err){
                        errMessage = err;
                    }else{
                        alert('xhr.responseJSON.message');
                        errMessage = xhr.responseJSON.message;
                    }
                    $("#successModal .modal-body p").text('error = ' + errMessage);
                    console.log(errMessage);
                    console.log("Details0: " + desc + "\nError:" + err);
                }
            });
        }
    </script>

</head>

<body>

    <div class="">

    </div>


    <div style="background-color:#e5e5e5;padding:15px;text-align:center;">
        <h1>Hello World</h1>
    </div>

    <div style="overflow:auto">
        <div class="menu">
            <a href="/bo/lesRDV.html">RDVs</a>
            <a href="#">Link 2</a>
            <a href="#">Link 3</a>
            <a href="#">Link 4</a>
        </div>

        <div class="main">


            <div class="resu" id="resu">
            </div>

            <br>
            <form class="mt-4" action="/pro/upload" method="POST" enctype="multipart/form-data">
                <div class="form-group">
                    <input type="file" name="file" id="input-files" class="form-control-file border" />
                </div>
                <button type="submit" class="btn btn-primary">Envoyee</button>
            </form>
        </div>

        <div class="right">

            <div class="" id="afficheResu">
                <p></p>
            </div>
        </div>
    </div>

    <div style="background-color:#e5e5e5;text-align:center;padding:10px;margin-top:7px;">foo</div>





    <div class="modal fade" id="successModal" tabindex="-1" role="dialog" aria-labelledby="successModalLabel"
        aria-hidden="true">
        <div class="modal-content">
            <div class="modal-body">

                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <p></p>

                <form id="creerPraticien" name="contact" role="form">

                    <input id="praId" name="praId" type="hidden" value="">

                    <input type="file" name="imgProfil" id="imgProfil" />

                    <div class="form-group">
                        <label for="id_speCat" class="col-form-label">Specialite:</label>
                        <select class="form-control" id="id_speCat" name="id_speCat"></select>
                    </div>

                    <div class="form-group">
                        <label for="titre" class="col-form-label">Titre:</label>
                        <select class="form-control" id="titre" name="titre">
                            <option value="">--Choisir Titre--</option>
                            <option value="MR">MR</option>
                            <option value="MD">MD</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="nom" class="col-form-label">Nom:</label>
                        <input type="text" class="form-control" id="nom" name="nom">
                    </div>
                    <div class="form-group">
                        <label for="prenom" class="col-form-label">Prenom:</label>
                        <input type="text" class="form-control" id="prenom" name="prenom">
                    </div>

                    <div class="form-group">
                        <label for="telephone" class="col-form-label">Telephone:</label>
                        <input type="text" class="form-control" id="telephone" name="telephone">
                    </div>

                    <div class="form-group">
                        <label for="fax" class="col-form-label">Fax:</label>
                        <input type="text" class="form-control" id="fax" name="fax">
                    </div>

                    <div class="form-group">
                        <label for="email" class="col-form-label">Email:</label>
                        <input type="text" class="form-control" id="email" name="email">
                    </div>

                    <div class="form-group">
                        <label for="motpasse" class="col-form-label">Pws:</label>
                        <input type="text" class="form-control" id="motpasse" name="motpasse">
                    </div>
                    <div class="form-group">
                        <label for="motpasseConfirme" class="col-form-label">Pws Confirm:</label>
                        <input type="text" class="form-control" id="motpasseConfirme" name="motpasseConfirme">
                    </div>

                    <div class="form-group">
                        <label for="dateNaissance" class="col-form-label">Date de naissance:</label>
                        <input type="date" class="form-control" name="dateNaissance" id="dateNaissance" value=""
                            min="1900-01-01" max="2022-12-31">
                    </div>

                    <div class="form-group">
                        <label for="numero" class="col-form-label">Numero:</label>
                        <input type="text" class="form-control" id="numero" name="numero">
                    </div>
                    <div class="form-group">
                        <label for="voie" class="col-form-label">Voie:</label>
                        <input type="text" class="form-control" id="voie" name="voie">
                    </div>
                    <div class="form-group">
                        <label for="codePostale" class="col-form-label">CP:</label>
                        <input type="text" class="form-control" id="codePostale" name="codePostale">
                    </div>
                    <div class="form-group">
                        <label for="ville" class="col-form-label">Ville:</label>
                        <input type="text" class="form-control" id="ville" name="ville">
                    </div>

                    <table>
                        <tr>
                            <td>
                                <label for="matinDebut" class="col-form-label">Mat heure deb:</label>
                                <input type="text" class="form-control" id="matinDebut" name="matinDebut"
                                    value="08:00:00">
                            </td>
                            <td>
                                <label for="matinFin" class="col-form-label">Mat heure fin:</label>
                                <input type="text" class="form-control" id="matinFin" name="matinFin" value="12:00:00">
                            </td>
                            <td rowspan="2">
                                <label for="lun">Lun</label>
                                <input type="checkbox" id="lun" name="lun" value="1" checked
                                    onclick="if(this.checked)this.value=1;else this.value=0;">
                                <label for="mar">Mar</label>
                                <input type="checkbox" id="mar" name="mar" value="1" checked
                                    onclick="if(this.checked)this.value=1;else this.value=0;">
                                <label for="mer">Mer</label>
                                <input type="checkbox" id="mer" name="mer" value="1" checked
                                    onclick="if(this.checked)this.value=1;else this.value=0;">
                                <label for="jeu">Jeu</label>
                                <input type="checkbox" id="jeu" name="jeu" value="1" checked
                                    onclick="if(this.checked)this.value=1;else this.value=0;">
                                <label for="ven">Ven</label>
                                <input type="checkbox" id="ven" name="ven" value="1" checked
                                    onclick="if(this.checked)this.value=1;else this.value=0;">
                                <label for="sam">Sam</label>
                                <input type="checkbox" id="sam" name="sam" value="0"
                                    onclick="if(this.checked)this.value=1;else this.value=0;">
                                <label for="dim">Dim</label>
                                <input type="checkbox" id="dim" name="dim" value="0"
                                    onclick="if(this.checked)this.value=1;else this.value=0;">
                            </td>

                        </tr>
                        <tr>
                            <td>
                                <label for="soirDebut" class="col-form-label">Soire heure deb:</label>
                                <input type="text" class="form-control" id="soirDebut" name="soirDebut"
                                    value="14:00:00">
                            </td>
                            <td>
                                <label for="soirFin" class="col-form-label">Soire heure fin:</label>
                                <input type="text" class="form-control" id="soirFin" name="soirFin" value="18:00:00">
                            </td>
                        </tr>
                    </table>

                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Annuler</button>
                        <input id="buttonCreerPraticien" type="submit" class="btn btn-success success"
                            value="Modifier Praticien">
                    </div>

                </form>
            </div>
        </div>
    </div>




</body>

</html>